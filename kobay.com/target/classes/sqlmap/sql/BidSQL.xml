<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="QnaSpace">
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias alias="bidVO" type="kobay.com.service.BidVO"/>
	

	<!-- 경매 참가  -->
	<insert id="bid.insertBid" parameterClass="bidVO">
		INSERT INTO auctionBid
			(	
				bidUnq,
				auctionUnq,
	 			memberUnq,
				bidPrice,
				bidRdate,
				aucStatus
			)
		VALUES
			(	
				bid_seq.nextval,
				#auctionUnq#,
			    #memberUnq#,
			    #bidPrice#,			 
			    sysdate,
			    0
			)			
	</insert>
	
	<!-- 회원 별 경매 참가 금액 -->
	<select id="bid.myPrice" resultClass="bidVO">
		 SELECT
				bidUnq,
				auctionUnq,
				memberUnq,
				bidPrice,
				bidRdate,
				aucStatus
		FROM 	auctionBid		
		WHERE	auctionUnq=#auctionUnq#
		  AND	memberUnq=#memberUnq#
		  AND   bidPrice = (SELECT max(bidPrice)
		                    FROM auctionBid 
		                    WHERE memberUnq = #memberUnq#
                            and auctionUnq = #auctionUnq#
		                   )
	</select>
	
</sqlMap>